<!DOCTYPE html>
<html>
<!--
 csound.js minimal example
 Copyright (C) 2017 V Lazzarini
-->

<head>
    <title>WebAudio Csound</title>
    <style type="text/css">
        textarea.console {
            font-family: "Courier New";
            color: #00FF99;
            background-color: #000000
        }
    </style>
    <script type="text/javascript" src="js/csound.js"></script>
    <script type="text/javascript">
        // called by csound.js
        function moduleDidLoad() {
            csound.Play();
            csound.CompileOrc(
                "massign 1,1\n" +
                "instr 1 \n" +
                "icps = 440+rnd(440) \n" +
                "chnset icps, \"freq\" \n" +
                "a1 oscili 0.1, icps\n" +
                "outs a1,a1 \n" +
                "endin");
            document.getElementById("tit").innerHTML = "Click here to play";
        }

        function attachListeners() {
            document.getElementById("clickarea").
            addEventListener("click", Play);
        }

        var count = 0;

        function handleMessage(message) {
            var element = document.getElementById('console');
            element.value += message;
            element.scrollTop = 99999; // focus on bottom
            count += 1;
            if (count == 1000) {
                element.value = ' ';
                count = 0;
            }
        }


        // click handler
        function Play() {
            csound.Event("i 1 0 5");
        }
    </script>
</head>

<body>
    <div id="clickarea">
        <H1> Minimal </H1>
        <h3 id="tit"> </h3>
        <textarea class="console" cols="80" rows="24" id="console">
          Csound: not loaded</textarea>
    </div>
</body>

</html>
