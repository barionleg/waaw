<!doctype html>
<html>
  <head>
    <title>Csound Reverb</title>
  </head>

  <body>

  </body>

  <script src='js/CsoundObj.js'></script>

  <script>
let csoundObj;
const TEST_CSD = 
`
sr = 44100
ksmps = 32 
nchnls = 2
nchnls_i = 1
0dbfs = 1

instr 1
  ain inch 1
  al, ar freeverb ain,ain, 0.7, 0.5
  out  al, ar
endin
`;

    CsoundObj.importScripts("./js/").then(() => {


      csoundObj = new CsoundObj();

      csoundObj.enableAudioInput((res) => {
      
      if(res) {

        //csoundObj.setOption("-m0");
        csoundObj.compileOrc(TEST_CSD);
        csoundObj.readScore("i1 0 36000");
        csoundObj.setMessageCallback((msg) => document.body.innerText +=  msg + "\n");

        csoundObj.start();

      } else {
        alert("Unable to start microphone.");
      }
      })


    });

  </script>
</html>
